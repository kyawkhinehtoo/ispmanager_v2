import{A as C}from"./AppLayout-QCKSvVtg.js";import{P as D}from"./Pagination-6rrMUBE7.js";import{r as f,T as F,s as g,c as M,w as _,N as A,o as a,a as e,k as N,x as P,b,f as h,d as l,F as w,g as R,e as m,t as d}from"./app-CoiD8XWd.js";import{M as j}from"./vue3-multiselect.umd.min-Dk_uM7pd.js";import{V as E}from"./main-DSVfZSH2.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DT7VU9RY.js";const T={name:"ActivityLog",components:{AppLayout:C,Multiselect:j,VueDatePicker:E,Pagination:D},props:{activities:Object,errors:Object},setup(V){let t=f(!1),i=f(["Customer Created","Customer updated","Bill Receipt","Invoice updated","Receipt Reset"]);const o=f({date:"YYYY-MM-DD",month:"MMM"});function v(n){t.value=t.value===n?null:n}const p=F({general:null,option:null,dateRange:""});function x(){A.post("/activity-log",p,{preserveState:!0})}const u=()=>{p.reset(),x()};function y(){axios.post("/exportActivityLogExcel",p,{responseType:"blob"}).then(n=>{console.log(n);var s=document.createElement("a");document.body.appendChild(s),s.style="display: none";var r=new Blob([n.data],{type:n.headers["content-type"]});const c=document.createElement("a");c.href=window.URL.createObjectURL(r),c.download=`activity_${new Date().getTime()}.xlsx`,c.click()})}return{expandedRow:t,toggleDetails:v,searchForm:p,options:i,searchPort:x,resetSearch:u,formatter:o,doExcel:y}}},B={class:"py-2"},S={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-4"},O={class:"grid grid-cols-1 md:grid-cols-6 gap-2 w-full items-end"},U={class:"col-span-1"},Y={class:"mt-1 flex rounded-md w-full bg-gray-500"},z={class:"col-span-1 md:col-span-3 grid md:grid-cols-2 gap-2"},G={class:"mt-1 z-10"},I={class:"mt-1 text-xs"},q={class:"col-span-1 sm:col-span-2 flex space-x-2 justify-end pb-1"},H={key:0,class:"bg-white overflow-auto shadow-xl sm:rounded-lg"},J={class:"min-w-full divide-y divide-gray-200"},K={class:"bg-white divide-y divide-gray-200"},Q={class:"px-6 py-2 text-sm whitespace-nowrap"},W={class:"px-6 py-2 text-sm whitespace-nowrap"},X={class:"px-6 py-2 text-sm whitespace-nowrap"},Z={class:"px-6 py-2 text-sm whitespace-nowrap"},$={class:"px-6 py-2 text-sm whitespace-nowrap"},ee=["onClick"],te={key:0},se={key:0},oe={key:1},ae={key:0,class:"bg-indigo-100 text-gray-800"},le={class:"px-6 text-sm capitalize"},ne={class:"px-6 text-sm"},ie={class:"px-6 text-sm",colspan:"3"},re={key:1};function ce(V,t,i,o,v,p){const x=g("multiselect"),u=g("VueDatePicker"),y=g("pagination"),n=g("app-layout");return a(),M(n,null,{header:_(()=>t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"}," Activity Log ",-1)])),default:_(()=>[e("div",B,[e("div",S,[e("div",O,[e("div",U,[t[8]||(t[8]=e("label",{for:"sh_general",class:"block text-sm font-medium text-gray-700"},"General ",-1)),e("div",Y,[t[7]||(t[7]=e("span",{class:"z-0 leading-snug font-normal text-center text-blueGray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),N(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>o.searchForm.general=s),name:"sh_general",id:"sh_general",class:"pl-10 py-2.5 focus:ring-0 flex-1 block w-full rounded-md sm:text-sm border-gray-200 text-gray-600",placeholder:"General",tabindex:"1"},null,512),[[P,o.searchForm.general]])])]),e("div",z,[e("div",null,[t[9]||(t[9]=e("label",{for:"sh_dn",class:"block text-sm font-medium text-gray-700"},"Type ",-1)),e("div",G,[b(x,{"deselect-label":"Selected already",options:o.options,modelValue:o.searchForm.option,"onUpdate:modelValue":t[1]||(t[1]=s=>o.searchForm.option=s),multiple:!1,"allow-empty":!0,placeholder:"Choose Type"},null,8,["options","modelValue"])])]),e("div",null,[t[10]||(t[10]=e("label",{for:"dateRange",class:"block text-sm font-medium text-gray-700"},"Date Range ",-1)),e("div",I,[b(u,{modelValue:o.searchForm.dateRange,"onUpdate:modelValue":t[2]||(t[2]=s=>o.searchForm.dateRange=s),range:{partialRange:!1},placeholder:"Please choose Date Range","enable-time-picker":!1,"model-type":"yyyy-MM-dd",id:"dateRange",class:"text-gray-400 text-sm focus:ring focus:ring-indigo-500 focus:border-indigo-500 focus:ring-opacity-10 focus:outline-none"},null,8,["modelValue"])])])]),e("div",q,[e("a",{onClick:t[3]||(t[3]=(...s)=>o.searchPort&&o.searchPort(...s)),class:"cursor-pointer inline-flex items-center px-4 py-2.5 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring focus:ring-gray-300 disabled:opacity-25 transition"},t[11]||(t[11]=[h("Search "),e("i",{class:"ml-1 fa fa-search text-white",tabindex:"6"},null,-1)])),e("a",{onClick:t[4]||(t[4]=(...s)=>o.resetSearch&&o.resetSearch(...s)),class:"cursor-pointer inline-flex items-center px-4 py-2.5 bg-yellow-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-yellow-700 active:bg-yellow-900 focus:outline-none focus:border-yellow-900 focus:ring focus:ring-yellow-300 disabled:opacity-25 transition"},t[12]||(t[12]=[h("Reset "),e("i",{class:"ml-1 fa fa-eraser text-white",tabindex:"7"},null,-1)])),e("a",{onClick:t[5]||(t[5]=(...s)=>o.doExcel&&o.doExcel(...s)),class:"cursor-pointer inline-flex items-center px-4 py-2.5 bg-green-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-yellow-700 active:bg-yellow-900 focus:outline-none focus:border-yellow-900 focus:ring focus:ring-green-300 disabled:opacity-25 transition"},t[13]||(t[13]=[h(" Export "),e("i",{class:"ml-1 fa fa-file-excel text-white",tabindex:"8"},null,-1)]))])]),i.activities.data?(a(),l("div",H,[e("table",J,[t[17]||(t[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," No. "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Activity"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Change By"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," #")])],-1)),e("tbody",K,[(a(!0),l(w,null,R(i.activities.data,(s,r)=>(a(),l(w,{key:s.id},[e("tr",null,[e("td",Q,d(i.activities.from+r),1),e("td",W,d(s.description),1),e("td",X,d(s.causer),1),e("td",Z,d(s.date),1),e("td",$,[e("a",{href:"#",onClick:c=>o.toggleDetails(r),class:"ml-2"},[Object.keys(s.changes).length>0?(a(),l("span",te,[o.expandedRow===r?(a(),l("span",se,t[14]||(t[14]=[e("i",{class:"fa fa-circle-chevron-down text-indigo-400"},null,-1)]))):(a(),l("span",oe,t[15]||(t[15]=[e("i",{class:"fa fa-circle-chevron-right text-gray-400"},null,-1)])))])):m("",!0)],8,ee)])]),Object.keys(s.changes).length>0&&o.expandedRow===r?(a(),l("tr",ae,t[16]||(t[16]=[e("th",{class:"px-6 text-sm text-left",scope:"col"},"Field",-1),e("th",{class:"px-6 text-sm text-left",scope:"col"},"From",-1),e("th",{class:"px-6 text-sm text-left",scope:"col",colspan:"3"},"To",-1)]))):m("",!0),Object.keys(s.changes).length>0&&o.expandedRow===r?(a(!0),l(w,{key:1},R(s.changes,(c,k)=>(a(),l("tr",{key:k,class:"bg-indigo-50 text-gray-600"},[e("td",le,d(k.replace("_"," ")),1),e("td",ne,d(c.from??"N/A"),1),e("td",ie,d(c.to??"N/A"),1)]))),128)):m("",!0)],64))),128))])])])):m("",!0),i.activities.links?(a(),l("span",re,[b(y,{class:"mt-6",links:i.activities.links},null,8,["links"])])):m("",!0)])])]),_:1})}const fe=L(T,[["render",ce],["__scopeId","data-v-b54e37c6"]]);export{fe as default};
